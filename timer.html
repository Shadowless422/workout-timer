<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Workout Timer</title>
    <style>
        h1 {
            font-family: Courier, monospace;
            font-style: normal;
            text-align: center;
        }
        body {
            font-family: Helvetica, serif;
            font-style: normal;
            font-weight: bold;
            text-align: left;
        }
        table {
            margin-left: auto;
            margin-right: auto;
        }
    </style>
</head>
<body>
    <h1>Workout Timer</h1>
    <table>
        <tr>
            <td style="text-align: right">Current state</td>
            <td>
                <span id="running-state">Paused</span>
            </td>
        </tr>
        <tr>
            <td style="text-align: right">Current phase</td>
            <td>
                <span style="color: darkgreen" id="phase">Work</span>
            </td>
        </tr>
        <tr>
            <td style="text-align: right">Time left</td>
            <td>
                <span id="time-left">00:00</span>
            </td>
        </tr>
        <tr>
            <td style="text-align: right">Round</td>
            <td>
                <span id="round">1/1</span>
            </td>
        </tr>
        <tr>
            <td style="text-align: right">Cycle</td>
            <td>
                <span id="cycle">1/1</span>
            </td>
        </tr>
    </table>
</body>
<script src='/socket.io/socket.io.js'></script>
<script>
    const socket = io(); // Connect to the server

    // Listen for timer updates from the server
    // TODO: add feedback sounds for phase changes and 3,2,1 time left
    // TODO: change bg and text color according to the current phase
    socket.on('timer-update', (timerState, timerSettings) => {
        document.getElementById('running-state').innerText = timerState.isRunning ? 'Running' : 'Paused';
        document.getElementById('phase').innerText = timerState.phase;
        document.getElementById('time-left').innerText = formatTime(timerState.timeLeft);
        document.getElementById('round').innerText = `${timerState.round}/${timerSettings.rounds}`;
        document.getElementById('cycle').innerText = `${timerState.cycle}/${timerSettings.cycles}`;
    });

    // Utility function to format time as mm:ss
    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
    }
</script>
</html>